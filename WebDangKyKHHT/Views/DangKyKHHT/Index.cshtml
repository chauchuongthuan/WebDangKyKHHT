@{
    ViewBag.Title = "Index";
    Layout = "~/Views/Shared/DKKHHT.cshtml";
    DateTime atime = new DateTime(2021, 7, 14, 21, 10, 10);
    
}
<link href="@Url.Content("/css/dataTables.bootstrap4.min.css")" rel="stylesheet" />
<script src="@Url.Content("~/Scripts/jquery-3.4.1.min.js")"></script>
<script src="@Url.Content("/js/jquery.dataTables.min.js")"></script>
<script src="@Url.Content("/js/dataTables.bootstrap4.min.js")"></script>
<script>
    jQuery(document).ready(function ($) {
        var table = $('#tbMonHoc').DataTable({
            "lengthMenu": [20, 50, 100, 200],
            "ordering": false,
            "language": {
                "decimal": "",
                "emptyTable": "Không có dữ liệu",
                "info": "Hiện từ _START_ tới _END_ trong _TOTAL_ dòng",
                "infoEmpty": "Hiện từ 0 tới 0 trong 0 dòng",
                "infoFiltered": "(tìm kiếm từ _MAX_)",
                "infoPostFix": "",
                "thousands": ",",
                "lengthMenu": "Hiển thị _MENU_ dòng",
                "loadingRecords": "Đảng tải xuống...",
                "processing": "Đang xử lý...",
                "search": "Tìm kiếm:",
                "zeroRecords": "Không tìm thấy dữ liệu",
                "paginate": {
                    "first": "&laquo;",
                    "last": "&raquo;",
                    "next": "&rsaquo;",
                    "previous": "&lsaquo;"
                },
                "select": {
                    "rows": {
                        _: 'Đã chọn %d dòng',
                        0: ''
                    }
                }
            },
            "ajax": {
                "url": '@Url.Action("jsonMH", "DangKyKHHT")',
                "type": "POST",
                "data": function (d) {
                    d.hk = $("#hk option:selected").val();
                },
                "datatype": "json"
            },
            "columns": [
                { "data": "TenMH", "name": "TenMH" },
                { "data": "MaMH", "name": "MaMH" },
                { "data": "SoTinChi", "name": "SoTinChi" },
                { "data": "ID_HK", "name": "ID_HK" },
                {
                    "data": "IDMH",
                    "render": function (data) {
                        return '<a class="btn btn-info btnchoose" href="#" data-idmh="' + data + '">Chọn</a>'
                    }
                }
            ],
            "serverSide": "true",
            "processing": "true"
        });
        $('#hk').on('change', function () {
            table.ajax.reload();
        });
        $('#tbMonHoc').on('click', '.btnchoose', function (e) {
            e.preventDefault();
            idmh = $(this).data("idmh");
            dr = table.row($(this).parents('tr'))
            $.ajax({
                type: 'POST',
                url: '@Url.Action("addKhht", "DangKyKHHT")',
                data: { idMH: idmh },
                success: function (data) {
                    if (data.success) {
                        dr.remove().draw();
                    }
                }
            });
        });
    });

</script>


<!-- Title body -->
<div class="site-section">
    <div class="container">
        <div class="row">
            <div class="col-lg-8">
                <div class="row">
                    <div class="col-12">
                        <div class="section-title">
                            <h2>BẢNG ĐĂNG KÝ KẾ HOẠCH HỌC TẬP</h2>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
    @if (DateTime.Now <= atime)
    {
        <div class="container">
            <div class="row">
                <div class="col-8">
                    <a class="btn btn-primary" href="@Url.Action("edit", "DangKyKHHT")">Môn đã chọn</a>
                </div>
                <div class="col-4 text-right">
                    <div class="input-group">
                        Học kỳ: @Html.DropDownList("hk", (IEnumerable<SelectListItem>)ViewBag.ID_HK, new { @Class = "form-control" })
                    </div>
                </div>
                <div class="col-12">
                    <table class="table table-striped table-bordered" id="tbMonHoc" width="100%" cellspacing="0">
                        <thead>
                            <tr>
                                <th>Tên môn</th>
                                <th>Mã môn</th>
                                <th>Số tín chỉ</th>
                                <th>Học kì</th>
                                <th></th>
                            </tr>
                        </thead>
                    </table>
                </div>
            </div>
        </div>
    }
            else
            {
                    <strong>chưa tới tgian ...</strong>
            }

</div>