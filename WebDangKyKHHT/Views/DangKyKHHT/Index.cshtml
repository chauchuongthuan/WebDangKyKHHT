@model WebDangKyKHHT.ViewModels.KHHTsViewModel
@using Microsoft.AspNet.Identity


@{
    ViewBag.Title = "Index";
}
<script src="@Url.Content("~/Scripts/jquery-3.4.1.min.js")"></script>
<script type="text/javascript">
    $(document).ready(function () {
        $("#btnSave").click(function () {
            AddKHHT();
        });



        $("#btnSelectAll").click(function () {
            SelectAllMH()
        });
    });



    function SelectAllMH() {
        $.each($("#tableMH input[type=checkbox]"), function (index, data) {
            $(this).prop('checked', true);
        });
    }



    function AddKHHT() {
        var listOfIDMH = [];



        $.each($("#tableMH input[type=checkbox]:checked"), function (index, data) {
            listOfIDMH.push($(this).val());
        });



        $.ajax({
            async: true,
            type: 'POST',
            dataType: 'JSON',
            contentType: 'application/json; charset=utf-8',
            url: '/DangKyKHHT/Index',
            data: JSON.stringify({ ID_SV: $("#ddSV").val(), listOfIDMH: listOfIDMH }),
            success: function (data) {
                if (data.success === true) {
                    alert(data.message);
                }
            },
            error: function () {
                alert('There are some problem');
            }
        });
    }



</script>

<div class="site-navbar py-2 js-sticky-header site-navbar-target d-none pl-0 d-lg-block" role="banner">



    <div class="container">
        <div class="d-flex align-items-center">



            <div class="mr-auto">
                <nav class="site-navigation position-relative text-right" role="navigation">
                    <ul class="site-menu main-menu js-clone-nav mr-auto d-none pl-0 d-lg-block">
                        <li class="active">
                            <a href="@Url.Content("~/Home/Index")" class="nav-link text-left">Trang chủ</a>
                        </li>
                        <li>
                            <a href="@Url.Content("~/DangKyKHHT/Index")" class="nav-link text-left" style="color: #ff3333">Đăng ký kế hoạch học tập</a>
                        </li>
                        <li>
                            <a href="@Url.Content("~/MonHocs/Index")" class="nav-link text-left">Xem kế hoạch đào tạo</a>
                        </li>
                        <li>
                            <a href="#" class="nav-link text-left">Lịch sử đăng ký KHHT</a>
                        </li>
                        <li>
                            <a href="@Url.Content("~/AspNetRoles/Index")" class="nav-link text-left">Role</a>
                        </li>
                    </ul>
                </nav>
            </div>
        </div>
    </div>
</div>
<!-- Title body -->
<div class="site-section">
    <div class="container">
        <div class="row">
            <div class="col-lg-8">
                <div class="row">
                    <div class="col-12">
                        <div class="section-title">
                            <h2>BẢNG ĐĂNG KÝ KẾ HOẠCH HỌC TẬP</h2>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>


    @using (Html.BeginForm("Index", "DangKyKHHT", FormMethod.Post, new { }))
    {
        <div class="container">
            <div class="row">
                <div class="form-group">
                    Sinh viên
                    <br />
                    @if (Request.IsAuthenticated)
                    {
                        <input type="text" value="@User.Identity.GetUserId()" id="ddSV" /> @User.Identity.GetUserName()


                        @*@Html.DropDownListFor(model => model.ID_SV, Model.ListofSV, new { @class = "form-control", @id = "ddSV" })*@
                    }

                </div>
            </div>


            <div class="row">
                <h2>Danh sách môn học </h2>
                <br />
                <table class="table custom-table">
                    <thead>
                        <tr>
                            <th scope="col">
                                <label class="control control--checkbox">
                                    <input type="checkbox" class="js-check-all" />
                                    <div class="control__indicator"></div>
                                </label>
                            </th>
                            <th scope="col">Số thứ tự</th>
                            <th scope="col">Tên môn</th>
                            <th scope="col">Mã môn</th>
                            <th scope="col">Số tín chỉ</th>
                            <th scope="col">Học kỳ</th>
                        </tr>
                    </thead>
                    <tbody>
                        @foreach (var item in Model.ListofMH)
                        {
                            <tr scope="row" id="tableMH">
                                <th scope="row">
                                    <label class="control control--checkbox">
                                        <input type="checkbox" name="@item.TenMH" value="@item.IDMH" checked="@item.IsSelected" />
                                        <div class="control__indicator"></div>
                                    </label>
                                </th>
                                <td>@item.IDMH</td>
                                <td><p>@item.TenMH</p></td>
                                <td>
                                    @item.MaMH
                                </td>
                                <td>@item.SoTinChi</td>
                                <td>@item.ID_HK</td>
                            </tr>
                            <tr class="spacer"><td colspan="100"></td></tr>
                        }
                    </tbody>
                </table>
            </div>
            <div>
                <button type="button" value="Save" name="Save" id="btnSave" class="btn btn-secondary">Lưu</button>
            </div>
        </div>
    }



</div>